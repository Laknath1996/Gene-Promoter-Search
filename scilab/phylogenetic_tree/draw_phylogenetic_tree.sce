clear all;
clc;

//exec('helper_functions.sce');
exec('bm4320_phylogenetic_trees.sce');

numOfGenes = 22;
FastaFolderPath = '/Users/ashwin/Semester 7/Genomic Signal Processing/GSP_Codes/scilab/phylogenetic_tree/fasta';
f_files =  findfiles(FastaFolderPath,'*.fasta');
f_fileNames = gsort(f_files,'g','i');
organisms = {};
for i = 1:numOfGenes
    organisms{i} = part(f_fileNames(i), [4:$-6]);
end

idx = [21, 22, 19, 17, 16, 15, 14, 20, 2, 11, 13, 7, 18, 6, 1, 8, 9, 10, 3, 4, 5, 12];

t_labels = [];
for i = 1:length(idx)
    t_labels = [t_labels ; '[' + ascii(65-1+idx(i)) + '] ' + organisms{idx(i)}]
end

disp(t_labels);

//t_labels = ['U'; 'V'; 'S'; 'Q'; 'P'; 'O'; 'N'; 'T'; 'B'; 'K'; 'M'; 'G'; 'R'; 'F';'A'; 'H'; 'I'; 'J'; 'C'; 'D'; 'E'; 'L'];

S = [
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      88      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      87      86      81      41      41      42      41      40      41      40;
      100     100     100     100     100     100     100     100     100      96      96      96      87      86      81      41      41      42      41      40      41      40;
      96      96      96      96      96      96      96      96      96     100     100     100      87      86      81      41      41      41      41      40      41      40;
      96      96      96      96      96      96      96      96      96     100     100     100      87      86      81      41      41      41      41      40      41      40;
      96      96      96      96      96      96      96      96      96     100     100     100      87      85      81      41      41      41      40      40      41      40;
      88      88      88      88      88      88      88      87      87      87      87      87     100      86      82      40      40      40      39      39      39      38;
      86      86      86      86      86      86      86      86      86      86      86      85      86     100      83      40      40      40      40      39      40      39;
      81      81      81      81      81      81      81      81      81      81      81      81      82      83     100      41      41      40      40      39      40      39;
      41      41      41      41      41      41      41      41      41      41      41      41      40      40      41     100     100      97      96      85      85      84;
      41      41      41      41      41      41      41      41      41      41      41      41      40      40      41     100     100      97      96      86      85      84;
      42      42      42      42      42      42      42      42      42      41      41      41      40      40      40      97      97     100      96      86      86      85;
      41      41      41      41      41      41      41      41      41      41      41      40      39      40      40      96      96      96     100      86      86      85;
      40      40      40      40      40      40      40      40      40      40      40      40      39      39      39      85      86      86      86     100      88      86;
      41      41      41      41      41      41      41      41      41      41      41      41      39      40      40      85      85      86      86      88     100      85;
      40      40      40      40      40      40      40      40      40      40      40      40      38      39      39      84      84      85      85      86      85     100;
]
                      
D = 100*ones(numOfGenes, numOfGenes) - S;
 
//A = [
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.035  0.035  0.036  0.125  0.139  0.186  0.585 0.585  0.584  0.590  0.596  0.588  0.601;
//    0.035  0.035  0.035  0.035  0.035  0.035  0.035  0.035  0.035  0.000  0.000  0.004  0.134  0.145  0.187  0.588 0.588  0.588  0.594  0.600  0.592  0.604;
//    0.035  0.035  0.035  0.035  0.035  0.035  0.035  0.035  0.035  0.000  0.000  0.004  0.134  0.145  0.187  0.587 0.587  0.588  0.594  0.600  0.592  0.604;
//    0.036  0.036  0.036  0.036  0.036  0.036  0.036  0.036  0.036  0.004  0.004  0.000  0.135  0.145  0.188  0.589 0.589  0.589  0.595  0.602  0.592  0.604;
//    0.125  0.125  0.125  0.125  0.125  0.125  0.125  0.125  0.125  0.134  0.134  0.135  0.000  0.144  0.181  0.603 0.603  0.603  0.608  0.611  0.606  0.616;
//    0.139  0.139  0.139  0.139  0.139  0.139  0.139  0.139  0.139  0.145  0.145  0.145  0.144  0.000  0.171  0.597 0.597  0.598  0.602  0.609  0.604  0.609;
//    0.186  0.186  0.186  0.186  0.186  0.186  0.186  0.186  0.186  0.187  0.187  0.188  0.181  0.171  0.000  0.595 0.595  0.596  0.599  0.605  0.597  0.608;
//    0.585  0.585  0.585  0.585  0.585  0.585  0.585  0.585  0.585  0.588  0.587  0.589  0.603  0.597  0.595  0.000 0.001  0.026  0.043  0.145  0.148  0.157;
//    0.585  0.585  0.585  0.585  0.585  0.585  0.585  0.585  0.585  0.588  0.587  0.589  0.603  0.597  0.595  0.001 0.000  0.025  0.042  0.144  0.147  0.156;
//    0.584  0.584  0.584  0.584  0.584  0.584  0.584  0.584  0.584  0.588  0.588  0.589  0.603  0.598  0.596  0.026 0.025  0.000  0.041  0.139  0.142  0.153;
//    0.590  0.590  0.590  0.590  0.590  0.590  0.590  0.590  0.590  0.594  0.594  0.595  0.608  0.602  0.599  0.043 0.042  0.041  0.000  0.144  0.142  0.153;
//    0.596  0.596  0.596  0.596  0.596  0.596  0.596  0.596  0.596  0.600  0.600  0.602  0.611  0.609  0.605  0.145 0.144  0.139  0.144  0.000  0.122  0.137;
//    0.588  0.588  0.588  0.588  0.588  0.588  0.588  0.588  0.588  0.592  0.592  0.592  0.606  0.604  0.597  0.148 0.147  0.142  0.142  0.122  0.000  0.148;
//    0.601  0.601  0.601  0.601  0.601  0.601  0.601  0.601  0.601  0.604  0.604  0.604  0.616  0.609  0.608  0.157 0.156  0.153  0.153  0.137  0.148  0.000];

//B = A;

//t_labels=['AY746950.1'; 'AY746951.1'; 'AY746948.1'; 'AY746947.1'; 'AY746952.1'; 'AY746949.1'];
//
//A=[100      72      66      69      66      66;
//72     100      67      67      65      67;
//66      67     100      81      68      68;
//69      67      81     100      68      69;
//66      65      68      68     100      77;
//66      67      68      69      77     100];
//
//B = 100*ones(6,6)-A; // Convert similarity matrix into a distance matrix
//disp(B);

//t_labels=['A'; 'B'; 'C'; 'D'; 'E'];
//
//A = [0 1 16 14 15;
//     1 0 16 15 16;
//     16 16 0 16 16;
//     14 15 16 0 1;
//     15 16 16 1 0];

//disp('WPGMA Tree');
//print_wpgma_tree(D,t_labels);

disp('NJ Tree');
print_nj_tree(D,t_labels);


